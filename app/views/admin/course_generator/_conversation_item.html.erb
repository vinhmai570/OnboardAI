<!-- Individual Conversation Item -->
<%= form_with url: switch_conversation_admin_course_generator_index_path, method: :post, local: false,
              class: "conversation-form",
              data: { conversation_id: conversation.id } do |form| %>
  <%= form.hidden_field :conversation_id, value: conversation.id %>
<% end %>

<!-- Delete conversation form -->
<%= form_with url: delete_conversation_admin_course_generator_index_path, method: :delete, local: false,
              class: "delete-conversation-form",
              data: { conversation_id: conversation.id } do |form| %>
  <%= form.hidden_field :conversation_id, value: conversation.id %>
<% end %>

<div id="conversation-<%= conversation.id %>"
     class="p-2 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer text-xs conversation-item <%= 'bg-blue-50 border-blue-200' if defined?(@current_conversation) && @current_conversation == conversation %>"
     data-conversation-id="<%= conversation.id %>"
     onclick="switchConversation(<%= conversation.id %>)">
  <div class="flex items-center justify-between mb-1">
    <span class="text-blue-600 font-mono text-xs">#<%= conversation.id %></span>
    <div class="flex items-center space-x-2">
      <span class="text-gray-400 text-xs"><%= time_ago_in_words(conversation.last_message_at) %> ago</span>
      <button type="button"
              class="text-red-400 hover:text-red-600 p-1 rounded hover:bg-red-50"
              onclick="event.stopPropagation(); deleteConversation(<%= conversation.id %>)"
              title="Delete conversation"
              data-conversation-id="<%= conversation.id %>">
        <svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
        </svg>
      </button>
    </div>
  </div>
  <div class="font-medium text-gray-900 truncate mb-1" id="conversation-title-<%= conversation.id %>">
    <%= conversation.title %>
  </div>
  <div class="text-gray-500">
    <%= conversation.message_count %> messages
    <% if conversation.courses.any? %>
      â€¢ <%= conversation.courses.count %> course<%= 's' if conversation.courses.count != 1 %>
    <% end %>
  </div>
</div>
